<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><meta name=description content="Nym Validators provide privacy-enhanced credentials based on the testimony of a set of decentralized, blockchain-based issuing authorities."><meta name=author content="Nym Team"><link rel=icon href=/docs/images/favicon.png type=image/png><title>Validators :: Nym Docs</title><link href=/docs/css/nucleus.css?1620933932 rel=stylesheet><link href=/docs/css/fontawesome-all.min.css?1620933932 rel=stylesheet><link href=/docs/css/hybrid.css?1620933932 rel=stylesheet><link href=/docs/css/featherlight.min.css?1620933932 rel=stylesheet><link href=/docs/css/perfect-scrollbar.min.css?1620933932 rel=stylesheet><link href=/docs/css/auto-complete.css?1620933932 rel=stylesheet><link href=/docs/css/atom-one-dark-reasonable.css?1620933932 rel=stylesheet><link href=/docs/css/theme.css?1620933932 rel=stylesheet><link href=/docs/css/hugo-theme.css?1620933932 rel=stylesheet><link href=/docs/css/theme-green.css?1620933932 rel=stylesheet><script src=/docs/js/jquery-3.3.1.min.js?1620933932></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}:not(pre)>code+span.copy-to-clipboard{display:none}</style></head><body data-url=/docs/run-nym-nodes/validators/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/docs><img width=40px height=10px src=/docs/images/nym-logo.svg alt="Nym Logo"></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/docs/js/lunr.min.js?1620933932></script><script type=text/javascript src=/docs/js/auto-complete.js?1620933932></script><script type=text/javascript>var baseurl="https://nymtech.net/docs/"</script><script type=text/javascript src=/docs/js/search.js?1620933932></script></div><div class=highlightable><ul class=topics><li data-nav-id=/docs/overview/ title=Overview class=dd-item><a href=/docs/overview/>Overview</a><ul><li data-nav-id=/docs/overview/nym-platform/ title="The Nym Platform" class=dd-item><a href=/docs/overview/nym-platform/>The Nym Platform</a></li><li data-nav-id=/docs/overview/network-privacy/ title="Network Privacy" class=dd-item><a href=/docs/overview/network-privacy/>Network Privacy</a></li><li data-nav-id=/docs/overview/private-access-control/ title=Coconut class=dd-item><a href=/docs/overview/private-access-control/>Coconut</a></li><li data-nav-id=/docs/overview/links/ title=Links class=dd-item><a href=/docs/overview/links/>Links</a></li></ul></li><li data-nav-id=/docs/run-nym-nodes/ title="Run Nym Nodes" class="dd-item
parent"><a href=/docs/run-nym-nodes/>Run Nym Nodes</a><ul><li data-nav-id=/docs/run-nym-nodes/incentives/ title=Incentives class=dd-item><a href=/docs/run-nym-nodes/incentives/>Incentives</a></li><li data-nav-id=/docs/run-nym-nodes/build-nym/ title="Building Nym" class=dd-item><a href=/docs/run-nym-nodes/build-nym/>Building Nym</a></li><li data-nav-id=/docs/run-nym-nodes/mixnodes/ title=Mixnodes class=dd-item><a href=/docs/run-nym-nodes/mixnodes/>Mixnodes</a></li><li data-nav-id=/docs/run-nym-nodes/validators/ title=Validators class="dd-item active"><a href=/docs/run-nym-nodes/validators/>Validators</a></li><li data-nav-id=/docs/run-nym-nodes/requester/ title=Requesters class=dd-item><a href=/docs/run-nym-nodes/requester/>Requesters</a></li><li data-nav-id=/docs/run-nym-nodes/gateways/ title=Gateways class=dd-item><a href=/docs/run-nym-nodes/gateways/>Gateways</a></li><li data-nav-id=/docs/run-nym-nodes/troubleshooting/ title="Mixnode Troubleshooting FAQ" class=dd-item><a href=/docs/run-nym-nodes/troubleshooting/>Mixnode Troubleshooting FAQ</a></li></ul></li><li data-nav-id=/docs/use-apps/ title="Use Apps" class=dd-item><a href=/docs/use-apps/>Use Apps</a><ul><li data-nav-id=/docs/use-apps/blockstream-green/ title="Blockstream Green" class=dd-item><a href=/docs/use-apps/blockstream-green/>Blockstream Green</a></li><li data-nav-id=/docs/use-apps/electrum/ title=Electrum class=dd-item><a href=/docs/use-apps/electrum/>Electrum</a></li><li data-nav-id=/docs/use-apps/keybase/ title=KeyBase class=dd-item><a href=/docs/use-apps/keybase/>KeyBase</a></li></ul></li><li data-nav-id=/docs/build-apps/ title="Build Apps" class=dd-item><a href=/docs/build-apps/>Build Apps</a><ul><li data-nav-id=/docs/build-apps/choose-a-client/ title="Choose a client" class=dd-item><a href=/docs/build-apps/choose-a-client/>Choose a client</a></li><li data-nav-id=/docs/build-apps/websocket-client/ title="Websocket client" class=dd-item><a href=/docs/build-apps/websocket-client/>Websocket client</a></li><li data-nav-id=/docs/build-apps/wasm-client/ title="Webassembly client" class=dd-item><a href=/docs/build-apps/wasm-client/>Webassembly client</a></li><li data-nav-id=/docs/build-apps/demos/ title=Demos class=dd-item><a href=/docs/build-apps/demos/>Demos</a></li></ul></li><li data-nav-id=/docs/community/ title=Community class=dd-item><a href=/docs/community/>Community</a><ul><li data-nav-id=/docs/community/code-of-conduct/ title="Code of Conduct" class=dd-item><a href=/docs/community/code-of-conduct/>Code of Conduct</a></li><li data-nav-id=/docs/community/licensing/ title=Licensing class=dd-item><a href=/docs/community/licensing/>Licensing</a></li></ul></li></ul><section id=shortcuts><h3>Community</h3><ul><li><a class=padding href=https://nymtech.net><i class="fas fa-fw fa-bullhorn"></i> Website</a></li><li><a class=padding href=https://medium.com/nymtech><i class="fab fa-fw fa-medium"></i> Blog</a></li><li><a class=padding href=https://github.com/nymtech/><i class="fab fa-fw fa-github"></i> Github</a></li><li><a class=padding href=https://nymtech.net/docs/overview/links/><i class="fas fa-fw fa-key"></i> Developer Chat</a></li><li><a class=padding href=https://twitter.com/nymproject/><i class="fab fa-fw fa-twitter"></i> Twitter</a></li><li><a class=padding href=https://t.me/nymchan><i class="fab fa-fw fa-telegram"></i> Telegram</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/docs/>Nym</a> > <a href=/docs/run-nym-nodes/>Run Nym Nodes</a> > Validators</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#building-the-nym-validator>Building the Nym validator</a></li><li><a href=#initializing-your-validator>Initializing your validator</a></li><li><a href=#setting-up-your-validators-admin-user>Setting up your validator&rsquo;s admin user:</a></li><li><a href=#starting-your-validator>Starting your validator</a></li><li><a href=#automating-your-validator-with-systemd>Automating your validator with systemd</a></li><li><a href=#installing-and-configuring-nginx-for-https>Installing and configuring nginx for HTTPS</a></li><li><a href=#unjailing-your-validator>Unjailing your validator</a></li><li><a href=#day-2-operations-with-your-validator>Day 2 operations with your validator</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Validators</h1><p>Nym validators secure the network with a staking token, defending the network from Sybil attacks.</p><p>Validators also provide privacy-enhanced credentials based on the testimony of a set of decentralized, blockchain-based issuing authorities. Nym validators use a <a href=https://en.wikipedia.org/wiki/Digital_signature>signature scheme</a> called <a href=https://arxiv.org/abs/1802.07344>Coconut</a> to issue credentials. This allows privacy apps to generate anonymous resource claims through decentralised authorities, then use them with Service Providers.</p><p>The validator is built using <a href=https://cosmos.network>Cosmos SDK</a> and <a href=https://tendermint.com>Tendermint</a>, with a <a href=https://cosmwasm.com>CosmWasm</a> smart contract controlling the directory service, node bonding, and delegated mixnet staking.</p><h3 id=building-the-nym-validator>Building the Nym validator</h3><h4 id=prerequisites>Prerequisites</h4><ul><li><code>Go >= v1.15</code></li></ul><p><code>Go</code> can be installed via the following commands (taken from the <a href=https://github.com/Agoric/agoric-sdk/wiki/Validator-Guide-for-Incentivized-Testnet#install-go>Agoric SDK docs</a>):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e># First remove any existing old Go installation</span>
sudo rm -rf /usr/local/go

<span style=color:#75715e># Install correct Go version</span>
curl https://dl.google.com/go/correct.go.version.linux-amd64.tar.gz | sudo tar -C/usr/local -zxvf -

<span style=color:#75715e># Update environment variables to include go</span>
cat <span style=color:#e6db74>&lt;&lt;&#39;EOF&#39; &gt;&gt;$HOME/.profile
</span><span style=color:#e6db74>export GOROOT=/usr/local/go
</span><span style=color:#e6db74>export GOPATH=$HOME/go
</span><span style=color:#e6db74>export GO111MODULE=on
</span><span style=color:#e6db74>export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin
</span><span style=color:#e6db74>EOF</span>
source $HOME/.profile

</code></pre></div><p>Remember to replace <code>correct.go.version</code> with the version of your choice from the Go releases page. For example:</p><p><code>correct.go.version.linux-amd64.tar.gz => go1.15.7.linux-amd64.tar.gz</code></p><p>Verify <code>Go</code> is installed with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>go version
<span style=color:#75715e># Should return: go version go1.15.7 linux/amd64</span>
</code></pre></div><ul><li><code>gcc</code></li></ul><p><code>gcc</code> can be installed with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo apt install build-essential
<span style=color:#75715e># Optional additional manual pages can be installed with:</span>
sudo apt-get install manpages-dev
</code></pre></div><p>Verify <code>gcc</code> is installed with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>gcc --version
</code></pre></div><p>Which should return something like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>gcc <span style=color:#f92672>(</span>Ubuntu 7.4.0-1ubuntu1~18.04<span style=color:#f92672>)</span> 7.4.0
Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2017</span> Free Software Foundation, Inc.
This is free software; see the source <span style=color:#66d9ef>for</span> copying conditions.  There is NO
warranty; not even <span style=color:#66d9ef>for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</code></pre></div><h4 id=building-your-validator>Building your validator</h4><p>We use the <code>wasmd</code> version of the Cosmos validator to run our blockchain. Run this to clone, compile, and build it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>WASMD_VERSION<span style=color:#f92672>=</span>v0.14.1
BECH32_PREFIX<span style=color:#f92672>=</span>hal
git clone https://github.com/CosmWasm/wasmd.git
cd wasmd
git checkout <span style=color:#e6db74>${</span>WASMD_VERSION<span style=color:#e6db74>}</span>
mkdir build
go build -o build/nymd -mod<span style=color:#f92672>=</span>readonly -tags <span style=color:#e6db74>&#34;netgo,ledger&#34;</span> -ldflags <span style=color:#e6db74>&#34;-X github.com/cosmos/cosmos-sdk/version.Name=nymd -X github.com/cosmos/cosmos-sdk/version.AppName=nymd -X github.com/CosmWasm/wasmd/app.NodeDir=.nymd -X github.com/cosmos/cosmos-sdk/version.Version=</span><span style=color:#e6db74>${</span>WASMD_VERSION<span style=color:#e6db74>}</span><span style=color:#e6db74> -X github.com/cosmos/cosmos-sdk/version.Commit=1920f80d181adbeaedac1eeea1c1c6e1704d3e49 -X github.com/CosmWasm/wasmd/app.Bech32Prefix=</span><span style=color:#e6db74>${</span>BECH32_PREFIX<span style=color:#e6db74>}</span><span style=color:#e6db74> -X &#39;github.com/cosmos/cosmos-sdk/version.BuildTags=netgo,ledger&#39;&#34;</span> -trimpath ./cmd/wasmd <span style=color:#75715e># noqa line-length</span>
</code></pre></div><p>At this point, you will have a copy of the <code>nymd</code> binary in your <code>build/</code> directory. Test that it&rsquo;s compiled properly by running:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>./build/nymd
</code></pre></div><p>You should see <code>nymd</code> help text print out.</p><p>Both the <code>nymd</code> and <code>libwasmvm.so</code> shared object library binary have been compiled. <code>libwasmvm.so</code> is the wasm virtual machine which is needed to execute Nym smart contracts.</p><blockquote><p>If you have compiled these files locally you need to upload both of them to the server on which the validator will run. <strong>If you have instead compiled them on the server skip to the step outlining setting <code>LD_LIBRARY PATH</code> below.</strong> To locate these files on your local system run:</p></blockquote><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>WASMVM_SO<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>ldd build/nymd | grep libwasmvm.so | awk <span style=color:#e6db74>&#39;{ print $3 }&#39;</span><span style=color:#66d9ef>)</span>
ls <span style=color:#e6db74>${</span>WASMVM_SO<span style=color:#e6db74>}</span>
</code></pre></div><p>This will output something like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#e6db74>&#39;/home/username/go/pkg/mod/github.com/!cosm!wasm/wasmvm@v0.13.0/api/libwasmvm.so&#39;</span>
</code></pre></div><p>When you upload your <code>nymd</code> binary, you&rsquo;ll need to tell it where <code>libwasmvm.so</code> is when you start your validator, or <code>nymd</code> will not run. If you have compiled them on your server then this is not necessary, as the compiled <code>nymd</code> already has access to <code>libwasmvm.so</code>.</p><p>Alternatively, you can check out the repository for <code>nym</code> at <a href=https://github.com/nymtech/nym>https://github.com/nymtech/nym</a> and use the tag for the current release with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>git clone https://github.com/nymtech/nym.git
cd nym
git reset --hard   <span style=color:#75715e># in case you made any changes on your branch</span>
git pull           <span style=color:#75715e># in case you&#39;ve checked it out before</span>
git checkout tags/v0.10.0
</code></pre></div><p>Inside the folder <code>validator</code> you will find the precompiled binaries to use.</p><p>Upload both <code>nymd</code> and <code>libwasmvm.so</code> to your validator machine. If you attempt to run <code>./nymd</code> on your server, you&rsquo;ll likely see an error if <code>nymd</code> can&rsquo;t find <code>libwasmvm.so</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>./nymd: error <span style=color:#66d9ef>while</span> loading shared libraries: libwasmvm.so: cannot open shared object file: No such file or directory
</code></pre></div><p>You&rsquo;ll need to set <code>LD_LIBRARY_PATH</code> in your user&rsquo;s <code>~/.bashrc</code> file, and add that to our path. Replace <code>/home/youruser/path/to/nym/binaries</code> in the command below to the locations of <code>nymd</code> and <code>libwasmvm.so</code> and run it. If you have compiled these on the server, they will be in the <code>build/</code> folder:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>NYM_BINARIES<span style=color:#f92672>=</span>/home/youruser/path/to/nym/binaries
echo <span style=color:#e6db74>&#39;export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:&#39;</span>NYM_BINARIES &gt;&gt; ~/.bashrc
echo <span style=color:#e6db74>&#39;export PATH=$PATH:&#39;</span><span style=color:#e6db74>${</span>NYM_BINARIES<span style=color:#e6db74>}</span> &gt;&gt; ~/.bashrc
source ~/.bashrc
</code></pre></div><p>Test everything worked:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd
</code></pre></div><p>This should return the regular <code>nymd</code> help text.</p><h3 id=initializing-your-validator>Initializing your validator</h3><p>Prerequisites:</p><ul><li>FQDN Domain name</li><li>IPv4 and IPv6 connectivity</li></ul><p>Choose a name for your validator and use it in place of <code>yourname</code> in the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd init yourname --chain-id testnet-finney
</code></pre></div><p>At this point, you have a new validator, with its own genesis file located at <code>$HOME/.nymd/config/genesis.json</code>. You will need to <strong>replace the contents of that file</strong> that with Nym&rsquo;s <a href=https://nymtech.net/testnets/finney/genesis.json>testnet-finney genesis file</a>.</p><p>You can use the following command to download the one for Finney with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>wget  -O $HOME/.nymd/config/genesis.json https://nymtech.net/testnets/finney/genesis.json
</code></pre></div><h4 id=configtoml-setup>config.toml setup</h4><p>Add the Nym validator as a persistent peer so that your validator can start pulling blocks from the rest of the network, by editing the following config options in <code>$HOME/.nymd/config/config.toml</code> to match the information below:</p><ul><li><code>cors_allowed_origins = ["*"]</code> allows the web wallet to make HTTPS requests to your validator.</li><li><code>persistent_peers = "e7163ea63219504344c669164d083f52434f382b@testnet-finney-validator.nymtech.net:26656"</code> allows your validator to start pulling blocks from other validators</li><li><code>create_empty_blocks = false</code> may save a bit of space</li></ul><p>Optionally, if you want to enable <a href=https://prometheus.io/>Prometheus</a> metrics then the following must also match in the <code>config.toml</code>:</p><ul><li><code>prometheus = true</code></li><li><code>prometheus_listen_addr = ":26660"</code></li></ul><p>And if you wish to add a human-readable moniker to your node:</p><ul><li><code>moniker = "yourname"</code></li></ul><p>Finally, if you plan on using <a href=https://cockpit-project.org/documentation.html>Cockpit</a> on your server, change the <code>grpc</code> port from <code>9090</code> as this is the port used by Cockpit.</p><h4 id=apptoml-setup>app.toml setup</h4><p>In the file <code>$HOME/.nymd/config/app.toml</code>, set the following values:</p><ol><li><code>minimum-gas-prices = "0.025uhal"</code></li><li><code>enable = true</code> in the <code>[api]</code> section to get the API server running</li></ol><h3 id=setting-up-your-validators-admin-user>Setting up your validator&rsquo;s admin user:</h3><p>You&rsquo;ll need an admin account to be in charge of your validator. Set that up with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd keys add nymd-admin
</code></pre></div><p>This will add keys for your administrator account to your system&rsquo;s keychain.</p><p>The command output should look something like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ nymd keys add nymd-admin
Enter keyring passphrase:
password must be at least <span style=color:#ae81ff>8</span> characters
Enter keyring passphrase:
Re-enter keyring passphrase:

- name: nymd-admin
type: local
address: hal1x4twq82ew2c49ctr36mafksyrtnxwvrkey939u
pubkey: halpub1addwnpepqdfcf5786qry8g8ef9nad5vnl0rs5cmkcywzrwwvvdye27ktjmqw2ygr2hr
mnemonic: <span style=color:#e6db74>&#34;&#34;</span>
threshold: <span style=color:#ae81ff>0</span>
pubkeys: <span style=color:#f92672>[]</span>


**Important** write this mnemonic phrase in a safe place.
It is the only way to recover your account <span style=color:#66d9ef>if</span> you ever forget your password.

design payment apple input doll left badge never toe claw coconut neither travel side castle know plate unit mercy weekend pelican stay fortune road
</code></pre></div><p>As the instructions say, remember to <strong>write down your mnemonic</strong>.</p><p>You can get the admin account&rsquo;s address with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd keys show nymd-admin -a
</code></pre></div><p>Type in your keychain <strong>password</strong>, not the mnemonic, when asked. The output should look something like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>hal1x4twq82ew2c49ctr36mafksyrtnxwvrkey939u
</code></pre></div><h3 id=starting-your-validator>Starting your validator</h3><p>Everything should now be ready to go. You&rsquo;ve got the validator set up, all changes made in <code>config.toml</code> and <code>app.toml</code>, the Nym genesis file copied into place (replacing the initial auto-generated one). Now let&rsquo;s validate the whole setup:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd validate-genesis
</code></pre></div><p>If this check passes, you should receive the following output:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>File at /path/to/.nymd/config/genesis.json is a valid genesis file
</code></pre></div><blockquote><p>If this test did not pass, check that you have replaced the contents of <code>/path/to/.nymd/config/genesis.json</code> with that of the <a href=https://nymtech.net/testnets/finney/genesis.json>testnet-finney genesis file</a>.</p></blockquote><p>Before starting the validator, we will need to open the firewall ports (adapt if not using <code>firewalld</code>):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#66d9ef>for</span> port in 1317/tcp 9090/tcp 26656/tcp 22/tcp 26660/tcp 80/tcp 443/tcp; <span style=color:#66d9ef>do</span>
firewall-cmd --add-port<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>port<span style=color:#e6db74>}</span>
firewall-cmd --add-port<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>port<span style=color:#e6db74>}</span> --permanent
<span style=color:#66d9ef>done</span>
</code></pre></div><p>Ports <code>22</code>, <code>80</code>, and <code>443</code> are for ssh, http, and https connections respectively. The rest of the ports are documented <a href=https://docs.cosmos.network/v0.42/core/grpc_rest.html>here</a>.</p><blockquote><p>If you are planning to use <a href=https://cockpit-project.org/>Cockpit</a> on your validator server then you will have defined a different <code>grpc</code> port in your <code>config.toml</code> above: remember to open this port as well.</p></blockquote><p>Start the validator:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd start
</code></pre></div><p>Once your validator starts, it will start requesting blocks from other validators. This may take several hours. Once it&rsquo;s up to date, you can issue a request to join the validator set:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>PUB_KEY<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>/home/youruser/path/to/nym/binaries/nymd tendermint show-validator<span style=color:#66d9ef>)</span> <span style=color:#75715e># e.g. halvalconspub1zcjduepqzw38hj6edjc5wldj3d37hwc4savn0t95uakhy6tmeqqz5wrfmntsnyehsq</span>
MONIKER<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nym-secondary&#34;</span>                                                       <span style=color:#75715e># whatever you called your validator</span>
FROM_ACCOUNT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nymd-admin&#34;</span>                                                     <span style=color:#75715e># your keychain name</span>

nymd tx staking create-validator <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--amount<span style=color:#f92672>=</span>10000000stake <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--fees<span style=color:#f92672>=</span>5000uhal <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--pubkey<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>PUB_KEY<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--moniker<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>MONIKER<span style=color:#e6db74>}</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--chain-id<span style=color:#f92672>=</span>testnet-finney <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--commission-rate<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0.10&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--commission-max-rate<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0.20&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--commission-max-change-rate<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0.01&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--min-self-delegation<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--gas<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;auto&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--gas-adjustment<span style=color:#f92672>=</span>1.15 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--from<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>FROM_ACCOUNT<span style=color:#e6db74>}</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>--node https://testnet-finney-validator.nymtech.net:443
</code></pre></div><p>You&rsquo;ll need <code>stake</code> coins for this.</p><p>Note: we are currently working towards building up a closed set of reputable validators. You can ask us for coins to get in, but please don&rsquo;t be offended if we say no - validators are part of our system&rsquo;s core security and we are starting out with people we already know or who have a solid reputation.</p><p>If you want to edit some details for your node you will use a command like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd tx staking edit-validator   --chain-id<span style=color:#f92672>=</span>testnet-finney   --moniker<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>MONIKER<span style=color:#e6db74>}</span>   --details<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Nym validator&#34;</span>   --security-contact<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;YOUREMAIL&#34;</span>   --identity<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;XXXXXXX&#34;</span>   --gas<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;auto&#34;</span>   --gas-adjustment<span style=color:#f92672>=</span>1.15   --from<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>FROM_ACCOUNT<span style=color:#e6db74>}</span> --fees 2000uhal
</code></pre></div><p>With above command you can specify the <code>gpg</code> key last numbers (as used in <code>keybase</code>) as well as validator details and your email for security contact~</p><h3 id=automating-your-validator-with-systemd>Automating your validator with systemd</h3><p>You will most likely want to automate your validator restarting if your server reboots. Below is a systemd unit file to place at <code>/etc/systemd/system/nymd.service</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#66d9ef>[Unit]</span>
<span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Nymd (0.10.0)</span>

<span style=color:#66d9ef>[Service]</span>
<span style=color:#a6e22e>User</span><span style=color:#f92672>=</span><span style=color:#e6db74>nym                                                          # change to your user</span>
<span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>simple</span>
<span style=color:#a6e22e>Environment</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;LD_LIBRARY_PATH=/home/youruser/path/to/nym/binaries&#34; # change to correct path</span>
<span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#e6db74>/home/youruser/path/to/nym/binaries/nymd start          # change to correct path</span>
<span style=color:#a6e22e>Restart</span><span style=color:#f92672>=</span><span style=color:#e6db74>on-failure</span>
<span style=color:#a6e22e>RestartSec</span><span style=color:#f92672>=</span><span style=color:#e6db74>30</span>
<span style=color:#a6e22e>StartLimitInterval</span><span style=color:#f92672>=</span><span style=color:#e6db74>350</span>
<span style=color:#a6e22e>StartLimitBurst</span><span style=color:#f92672>=</span><span style=color:#e6db74>10</span>

<span style=color:#66d9ef>[Install]</span>
<span style=color:#a6e22e>WantedBy</span><span style=color:#f92672>=</span><span style=color:#e6db74>multi-user.target</span>
</code></pre></div><p>Proceed to start it with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>systemctl daemon-reload <span style=color:#75715e># to pickup the new unit file</span>
systemctl enable nymd   <span style=color:#75715e># to enable the service</span>
systemctl start nymd    <span style=color:#75715e># to actually start the service</span>
journalctl -f           <span style=color:#75715e># to monitor system logs showing the service start</span>
</code></pre></div><h3 id=installing-and-configuring-nginx-for-https>Installing and configuring nginx for HTTPS</h3><h4 id=setup>Setup</h4><p><a href="https://www.nginx.com/resources/glossary/nginx/#:~:text=NGINX%20is%20open%20source%20software,%2C%20media%20streaming%2C%20and%20more.&text=In%20addition%20to%20its%20HTTP,%2C%20TCP%2C%20and%20UDP%20servers.">Nginx</a> is an open source software used for operating high-performance web servers. It allows us to set up reverse proxying on our validator server to improve performance and security.</p><p>Install <code>nginx</code> and enable &ldquo;Nginx Full&rdquo; in your firewall.</p><p>Check nginx is running via systemctl:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>systemctl status nginx
</code></pre></div><p>Which should return:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>● nginx.service - A high performance web server and a reverse proxy server
   Loaded: loaded <span style=color:#f92672>(</span>/lib/systemd/system/nginx.service; enabled; vendor preset: enabled<span style=color:#f92672>)</span>
   Active: active <span style=color:#f92672>(</span>running<span style=color:#f92672>)</span> since Fri 2018-04-20 16:08:19 UTC; <span style=color:#ae81ff>3</span> days ago
     Docs: man:nginx<span style=color:#f92672>(</span>8<span style=color:#f92672>)</span>
 Main PID: <span style=color:#ae81ff>2369</span> <span style=color:#f92672>(</span>nginx<span style=color:#f92672>)</span>
    Tasks: <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>limit: 1153<span style=color:#f92672>)</span>
   CGroup: /system.slice/nginx.service
           ├─2369 nginx: master process /usr/sbin/nginx -g daemon on; master_process on;
           └─2380 nginx: worker process
</code></pre></div><h4 id=configuration>Configuration</h4><p>Proxying your validator&rsquo;s port <code>26657</code> to nginx port <code>80</code> can then be done by including the following in <code>/etc/nginx/conf.d/validator.conf</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>server <span style=color:#f92672>{</span>
  listen 80;
  listen <span style=color:#f92672>[</span>::<span style=color:#f92672>]</span>:80;
  server_name <span style=color:#f92672>{{</span> domain <span style=color:#f92672>}}</span>;

  location / <span style=color:#f92672>{</span>
    proxy_pass http://127.0.0.1:26657;
    proxy_set_headerX-Real-IP $remote_addr;
    proxy_set_headerHost $host;
    proxy_set_headerX-Real-IP $remote_addr;
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Followed by:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo apt install certbot nginx python3
certbot --nginx -d nym-validator.yourdomain.com -m you@yourdomain.com --agree-tos --noninteractive --redirect
</code></pre></div><p>These commands will get you an HTTPS encrypted nginx proxy in front of the API.</p><p>In the next testnet we will be focusing more on things such as validator TLS and sentry nodes.</p><h3 id=unjailing-your-validator>Unjailing your validator</h3><p>If, for some reason, your validator gets jailed, you can fix it with the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd tx slashing unjail <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --broadcast-mode<span style=color:#f92672>=</span>block <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --from<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>FROM_ACCOUNT<span style=color:#e6db74>}</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --chain-id<span style=color:#f92672>=</span>testnet-finney <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --gas<span style=color:#f92672>=</span>auto <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --gas-adjustment<span style=color:#f92672>=</span>1.4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --fees<span style=color:#f92672>=</span>7000uhal
</code></pre></div><h3 id=day-2-operations-with-your-validator>Day 2 operations with your validator</h3><p>As part of the execution of the validator, it will be able to get some rewards.</p><p>With this command, we can query our outstanding rewards:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd query distribution validator-outstanding-rewards &lt;halvaloperaddress&gt;

</code></pre></div><p>Using the values obtained from the previous command, you can withdraw all rewards with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd tx distribution withdraw-rewards &lt;halvaloperaddress&gt; --from <span style=color:#e6db74>${</span>FROM_ACCOUNT<span style=color:#e6db74>}</span> --keyring-backend<span style=color:#f92672>=</span>os --chain-id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;testnet-finney&#34;</span> --gas<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;auto&#34;</span> --gas-adjustment<span style=color:#f92672>=</span>1.15 --commission --fees 5000uhal
</code></pre></div><p>You can check your current balances with:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd query bank balances hal&lt;address&gt;
</code></pre></div><p>For example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>balances</span>:
- <span style=color:#f92672>amount</span>: <span style=color:#e6db74>&#34;22976200&#34;</span>
<span style=color:#f92672>denom</span>: <span style=color:#ae81ff>stake</span>
- <span style=color:#f92672>amount</span>: <span style=color:#e6db74>&#34;919376&#34;</span>
<span style=color:#f92672>denom</span>: <span style=color:#ae81ff>uhal</span>
<span style=color:#f92672>pagination</span>:
<span style=color:#f92672>next_key</span>: <span style=color:#66d9ef>null</span>
<span style=color:#f92672>total</span>: <span style=color:#e6db74>&#34;0&#34;</span>
</code></pre></div><p>You can, of course, stake back the available balance to your validator with the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nymd tx staking delegate &lt;halvaloperaddress&gt; &lt;amount&gt;stake--from <span style=color:#e6db74>${</span>FROM_ACCOUNT<span style=color:#e6db74>}</span> --keyring-backend<span style=color:#f92672>=</span>os --chain-id <span style=color:#e6db74>&#34;testnet-finney&#34;</span> --gas<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;auto&#34;</span> --gas-adjustment<span style=color:#f92672>=</span>1.15 --fees 5000uhal
</code></pre></div><p>NOTE: The value to be used instead of the <code>&lt;amount>stake</code> can be calculated from the available balance. For example, if you&rsquo;ve <code>999989990556</code> in the balance, you can stake <code>999909990556</code>, note that the 5th digit, has been changed from <code>8</code> to <code>0</code> to leave some room for fees (amounts are multiplied by 10^6).</p><p>Also remember to replace <code>halvaloper</code> with your validator address and <code>nym-admin</code> with the user you created during initialization.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/docs/run-nym-nodes/mixnodes/ title=Mixnodes><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/docs/run-nym-nodes/requester/ title=Requesters style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/docs/js/clipboard.min.js?1620933932></script><script src=/docs/js/perfect-scrollbar.min.js?1620933932></script><script src=/docs/js/perfect-scrollbar.jquery.min.js?1620933932></script><script src=/docs/js/jquery.sticky.js?1620933932></script><script src=/docs/js/featherlight.min.js?1620933932></script><script src=/docs/js/highlight.pack.js?1620933932></script><script>hljs.initHighlightingOnLoad()</script><script src=/docs/js/modernizr.custom-3.6.0.js?1620933932></script><script src=/docs/js/learn.js?1620933932></script><script src=/docs/js/hugo-learn.js?1620933932></script><link href=/docs/mermaid/mermaid.css?1620933932 rel=stylesheet><script src=/docs/mermaid/mermaid.js?1620933932></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>